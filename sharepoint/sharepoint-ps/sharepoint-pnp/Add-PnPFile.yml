### YamlMime:PowershellCmdlet
summary: |-
  > [!TIP]
  > We encourage you to make improvements to this documentation. Please navigate to https://github.com/pnp/powershell/blob/dev/documentation/Add-PnPFile.md to change this file.

  Uploads a file to Web
module: PnP.Powershell
links:
- text: Microsoft 365 Patterns and Practices
  href: https://aka.ms/m365pnp
syntaxes:
- >-
  Add-PnPFile -Path <String> -Folder <FolderPipeBind> [-NewFileName <String>] [-Checkout] [-CheckInComment <String>]

   [-Approve] [-ApproveComment <String>] [-Publish] [-PublishComment <String>] [-UseWebDav] [-Values <Hashtable>]

   [-ContentType <ContentTypePipeBind>] [-Connection <PnPConnection>] [<CommonParameters>]
- >-
  Add-PnPFile -Folder <FolderPipeBind> -FileName <String> -Stream <Stream> [-Checkout] [-CheckInComment <String>]

   [-Approve] [-ApproveComment <String>] [-Publish] [-PublishComment <String>] [-UseWebDav] [-Values <Hashtable>]

   [-ContentType <ContentTypePipeBind>] [-Connection <PnPConnection>] [<CommonParameters>]
examples:
- title: EXAMPLE 1
  code: |-
    Add-PnPFile -Path c:\temp\company.master -Folder "_catalogs/masterpage"
  description: |-
    This will upload the file company.master to the masterpage catalog
  summary: ""
- title: EXAMPLE 2
  code: |-
    Add-PnPFile -Path .\displaytemplate.html -Folder "_catalogs/masterpage/display templates/test"
  description: |-
    This will upload the file displaytemplate.html to the test folder in the display templates folder. If the test folder does not exist it will create it.
  summary: ""
- title: EXAMPLE 3
  code: |-
    Add-PnPFile -Path .\sample.doc -Folder "Shared Documents" -Values @{Modified="1/1/2016"}
  description: |-
    This will upload the file sample.doc to the Shared Documents folder. After uploading it will set the Modified date to 1/1/2016.
  summary: ""
- title: EXAMPLE 4
  code: |-
    Add-PnPFile -FileName sample.doc -Folder "Shared Documents" -Stream $fileStream -Values @{Modified="1/1/2016"}
  description: |-
    This will add a file sample.doc with the contents of the stream into the Shared Documents folder. After adding it will set the Modified date to 1/1/2016.
  summary: ""
- title: EXAMPLE 5
  code: |-
    Add-PnPFile -Path sample.doc -Folder "Shared Documents" -ContentType "Document" -Values @{Modified="1/1/2016"}
  description: |-
    This will add a file sample.doc to the Shared Documents folder, with a ContentType of 'Documents'. After adding it will set the Modified date to 1/1/2016.
  summary: ""
- title: EXAMPLE 6
  code: |-
    Add-PnPFile -Path sample.docx -Folder "Documents" -Values @{Modified="1/1/2016"; Created="1/1/2017"; Editor=23}
  description: |-
    This will add a file sample.docx to the Documents folder and will set the Modified date to 1/1/2016, Created date to 1/1/2017 and the Modified By field to the user with ID 23. To find out about the proper user ID to relate to a specific user, use Get-PnPUser.
  summary: ""
- title: EXAMPLE 7
  code: |-
    Add-PnPFile -Path sample.docx -Folder "Documents" -NewFileName "differentname.docx"
  description: |-
    This will upload a local file sample.docx to the Documents folder giving it the filename differentname.docx on SharePoint
  summary: ""
parameters:
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Approve
  description: |+
    Will auto approve the uploaded file

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ApproveComment
  description: |+
    The comment added to the approval

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: CheckInComment
  description: |+
    The comment added to the checkin

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Checkout
  description: |+
    If versioning is enabled, this will check out the file first if it exists, upload the file, then check it in again

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="PnPConnection" data-throw-if-not-resolved="False" />
  name: Connection
  description: |+
    Optional connection to be used by the cmdlet. Retrieve the value for this parameter by either specifying -ReturnConnection on Connect-PnPOnline or by executing Get-PnPConnection.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="ContentTypePipeBind" data-throw-if-not-resolved="False" />
  name: ContentType
  description: |+
    Use to assign a ContentType to the file

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: FileName
  isRequired: true
  description: |+
    Name for file

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="FolderPipeBind" data-throw-if-not-resolved="False" />
  name: Folder
  isRequired: true
  description: |+
    The destination folder in the site

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: NewFileName
  description: |+
    Filename to give the file on SharePoint

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Path
  isRequired: true
  description: |+
    The local file path

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Publish
  description: |+
    Will auto publish the file

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: PublishComment
  description: |+
    The comment added to the publish action

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Stream" data-throw-if-not-resolved="False" />
  name: Stream
  isRequired: true
  description: |+
    Stream with the file contents

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: UseWebDav
  description: ""
  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Hashtable" data-throw-if-not-resolved="False" />
  name: Values
  description: |+
    Use the internal names of the fields when specifying field names.

    Single line of text: -Values @{"Title" = "Title New"}

    Multiple lines of text: -Values @{"MultiText" = "New text\n\nMore text"}

    Rich text: -Values @{"MultiText" = "&lt;strong&gt;New&lt;/strong&gt; text"}

    Choice: -Values @{"Choice" = "Value 1"}

    Number: -Values @{"Number" = "10"}

    Currency: -Values @{"Number" = "10"}

    Currency: -Values @{"Currency" = "10"}

    Date and Time: -Values @{"DateAndTime" = "03/10/2015 14:16"}

    Lookup (id of lookup value): -Values @{"Lookup" = "2"}

    Multi value lookup (id of lookup values as array 1): -Values @{"MultiLookupField" = "1","2"}

    Multi value lookup (id of lookup values as array 2): -Values @{"MultiLookupField" = 1,2}

    Multi value lookup (id of lookup values as string): -Values @{"MultiLookupField" = "1,2"}

    Yes/No: -Values @{"YesNo" = $false}

    Person/Group (id of user/group in Site User Info List or email of the user, separate multiple values with a comma): -Values @{"Person" = "user1@domain.com","21"}

    Managed Metadata (single value with path to term): -Values @{"MetadataField" = "CORPORATE|DEPARTMENTS|FINANCE"}

    Managed Metadata (single value with id of term): -Values @{"MetadataField" = "fe40a95b-2144-4fa2-b82a-0b3d0299d818"} with Id of term

    Managed Metadata (multiple values with paths to terms): -Values @{"MetadataField" = "CORPORATE|DEPARTMENTS|FINANCE","CORPORATE|DEPARTMENTS|HR"}

    Managed Metadata (multiple values with ids of terms): -Values @{"MetadataField" = "fe40a95b-2144-4fa2-b82a-0b3d0299d818","52d88107-c2a8-4bf0-adfa-04bc2305b593"}

    Hyperlink or Picture: -Values @{"Hyperlink" = "https://github.com/OfficeDev/, OfficePnp"}

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
applicable:
- SharePoint Online
uid: PnP.Powershell.Add-PnPFile
name: Add-PnPFile
description: ""
metadata:
  Module Name: PnP.PowerShell
  schema: 2.0.0
  applicable: SharePoint Online
  online version: https://pnp.github.io/powershell/cmdlets/Add-PnPFile.html
  external help file: PnP.PowerShell.dll-Help.xml
  title: Add-PnPFile
