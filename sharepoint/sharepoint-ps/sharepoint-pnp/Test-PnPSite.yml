### YamlMime:PowershellCmdlet
summary: |-
  > [!TIP]
  > We encourage you to make improvements to this documentation. Please navigate to https://github.com/pnp/powershell/blob/dev/documentation/Test-PnPSite.md to change this file.


  **Required Permissions**

  * SharePoint: Access to the SharePoint Tenant Administration site

  Checks the site collection and its contents.
module: PnP.Powershell
links:
- text: Microsoft 365 Patterns and Practices
  href: https://aka.ms/m365pnp
syntaxes:
- Test-PnPSite -Identity <SitePipeBind> [-RuleId <Guid>]
examples:
- title: EXAMPLE 1
  code: |-
    Test-PnPSite -Identity "https://contoso.sharepoint.com/sites/marketing"
  description: |-
    This example runs all the site collection health checks on the https://contoso.sharepoint.com/sites/marketing site collection.
  summary: ""
- title: EXAMPLE 2
  code: |-
    Test-PnPSite -Identity "https://contoso.sharepoint.com/sites/marketing" -RuleID "ee967197-ccbe-4c00-88e4-e6fab81145e1"
  description: |-
    This example runs the Missing Galleries Check rule in test mode on the https://contoso.sharepoint.com/sites/marketing site collection.
  summary: ""
parameters:
- type: <xref href="SitePipeBind" data-throw-if-not-resolved="False" />
  name: Identity
  isRequired: true
  description: |+
    Specifies the SharePoint Online site collection on which to run the repairs.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="Guid" data-throw-if-not-resolved="False" />
  name: RuleId
  description: |+
    Specifies a health check rule to run.

    For example:

    * `"ee967197-ccbe-4c00-88e4-e6fab81145e1"` for Missing Galeries.
    * `"befe203b-a8c0-48c2-b5f0-27c10f9e1622"` for Conflicting Content Types.
    * `"a9a6769f-7289-4b9f-ae7f-5db4b997d284"` for Missing Parent Content Types.
    * `"5258ccf5-e7d6-4df7-b8ae-12fcc0513ebd"` for Missing Site Templates.
    * `"99c946f7-5751-417c-89d3-b9c8bb2d1f66"` for Unsupported Language Pack References.
    * `"6da06aab-c539-4e0d-b111-b1da4408859a"` for Unsupported MUI References.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
applicable:
- SharePoint Online
uid: PnP.Powershell.Test-PnPSite
name: Test-PnPSite
description: |-
  The Test-PnPSite cmdlet runs one or all site collection health checks on the site collection and its contents. Tests are intended not to make any changes except in repair mode, which can be initiated by running the Repair-PnPSite cmdlet. This cmdlet reports the rules together with a summary of the results.
metadata:
  Module Name: PnP.PowerShell
  title: Test-PnPSite
  schema: 2.0.0
  applicable: SharePoint Online
  external help file: PnP.PowerShell.dll-Help.xml
  online version: https://pnp.github.io/powershell/cmdlets/Test-PnPSite.html
