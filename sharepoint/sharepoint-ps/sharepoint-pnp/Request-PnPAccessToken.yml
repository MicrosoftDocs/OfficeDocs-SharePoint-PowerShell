### YamlMime:PowershellCmdlet
summary: |-
  > [!TIP]
  > We encourage you to make improvements to this documentation. Please navigate to https://github.com/pnp/powershell/blob/dev/documentation/Request-PnPAccessToken.md to change this file.

  Requests an OAuth Access token
module: PnP.Powershell
links:
- text: Microsoft 365 Patterns and Practices
  href: https://aka.ms/m365pnp
syntaxes:
- Request-PnPAccessToken [-ClientId <String>] [-Resource <String>] [-Scopes <String[]]>] [-Decoded]  [-Credentials <PSCredential>] [-TenantUrl <String>]
examples:
- title: EXAMPLE 1
  code: |-
    Request-PnPAccessToken
  description: |-
    Returns the access token using the default client id and scope
  summary: ""
- title: EXAMPLE 2
  code: |-
    Request-PnPAccessToken -ClientId 26e29fec-aa10-4f99-8381-d96cddc650c2
  description: |-
    Returns the access token using the specified client id and the default scope of AllSites.FullControl
  summary: ""
- title: EXAMPLE 3
  code: |-
    Request-PnPAccessToken -ClientId 26e29fec-aa10-4f99-8381-d96cddc650c2 -Scopes Group.ReadWrite.All
  description: |-
    Returns the access token using the specified client id and the specified scope
  summary: ""
- title: EXAMPLE 4
  code: |-
    Request-PnPAccessToken -ClientId 26e29fec-aa10-4f99-8381-d96cddc650c2 -Scopes Group.ReadWrite.All, AllSites.FullControl
  description: |-
    Returns the access token using the specified client id and the specified scopes
  summary: ""
parameters:
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: ClientId
  description: |+
    The Azure Application Client Id to use to retrieve the token. Defaults to the PnP Office 365 Management Shell

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="PSCredential" data-throw-if-not-resolved="False" />
  name: Credentials
  description: |+
    Optional credentials to use when retrieving the access token. If not present you need to connect first with Connect-PnPOnline.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="SwitchParameter" data-throw-if-not-resolved="False" />
  name: Decoded
  description: |+
    Returns the token in a decoded / human readible manner

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: Resource
  description: |+
    The scopes to retrieve the token for. Defaults to AllSites.FullControl

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" /><span>[</span><span>]</span>
  name: Scopes
  description: |+
    The scopes to retrieve the token for. Defaults to AllSites.FullControl

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
- type: <xref href="String" data-throw-if-not-resolved="False" />
  name: TenantUrl
  description: |+
    Optional tenant URL to use when retrieving the access token. The Url should be in the shape of https://yourtenant.sharepoint.com. See examples for more info.

  defaultValue: None
  position: Named
  aliases: ""
  parameterValueGroup: ""
applicable:
- SharePoint Online
uid: PnP.Powershell.Request-PnPAccessToken
name: Request-PnPAccessToken
description: |-
  Returns an access token using the password grant, using the PnP O365 Management Shell client id by default and the AllSites.FullControl scope by default.
metadata:
  Module Name: PnP.PowerShell
  title: Request-PnPAccessToken
  schema: 2.0.0
  applicable: SharePoint Online
  external help file: PnP.PowerShell.dll-Help.xml
  online version: https://pnp.github.io/powershell/cmdlets/Request-PnPAccessToken.html
